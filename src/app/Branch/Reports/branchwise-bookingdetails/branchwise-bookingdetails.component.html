<app-header></app-header>
<h5 class="text-center fw-bold text-danger" style=" margin-top: 8%;"><u>
    Parcel Branch Consolidated Report </u>
</h5>
<div class="card container" style=" 
border: 1px solid #ccc; 
border-radius: 5px;
background-color: #fff;">
  <!-- <div class="hr" style="  border: 1px solid #ccc; /* light gray border */
    background-color: #fff;"></div> -->
  <div class="text-center">
    <i class="fa fa-print" style="font-size: 40px; color: green;" aria-hidden="true" (click)="printReport()"></i>
    <i class="fa fa-file-excel-o mx-3" style="font-size: 34px; color: green; cursor: pointer;" (click)="exportToExcel()" aria-hidden="true"></i>
  </div>
  
  <div id="print-section">
    <div class="text-center mb-4 mt-5">
      <div class="container-fluid" *ngIf="pffffffdata">
        <h4 class="text-center fw-bold">{{ pffffffdata.companyId?.name }}</h4>
        <p class="text-center fw-bold">
          Address: {{ pffffffdata.location }} - {{ pffffffdata.branchId?.name }} |
          Phone No: {{ pffffffdata.phone }}
        </p>
      </div>
      <h6 class="text-decoration-underline">Daily Collection Report
      </h6>
    </div>
    <div class="table-responsive mb-1 ">
      <table class="table table-bordered table-sm text-center align-middle">
        <thead>
          <tr *ngIf="branchReportData">
            <th>From : {{branchReportData.fromDate | date: 'dd-MM-yyyy'}} To : {{branchReportData.toDate | date:
              'dd-MM-yyyy'}}</th>
            <th *ngIf="pfdata">Print By : {{pffffffdata.username
              }}</th>
            <th>Print Date :{{ today | date: 'dd-MM-yyyy' }} {{ today | date: 'hh:mm a' }} </th>
          </tr>
        </thead>
      </table>
    </div>


    <div class="table-responsive">
      <table class="table table-bordered table-sm text-center align-middle">
        <thead class="table-secondary">
          <!-- Custom Heading Row -->
          <tr>
            <th colspan="12" class="text-center">
              Booked Paid Details
            </th>
          </tr>
    
          <!-- Column Headers -->
          <tr class="table-secondary">
            <th>No</th>
            <th>LR No</th>
            <th>Booking Date</th>
            <th>Booked By</th>
            <th>Destination</th>
            <th>Consignor</th>
            <th>Consignee</th>
            <th>Pkgs</th>
            <th>Freight</th>
            <th>Door Pickup</th>
            <th>Other</th>
            <th>Net Amount</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of branchReportData?.BookingTypes?.paid; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ item.lrNumber }}</td>
            <td>{{ item.bookingDate | date:'dd-MM-yyyy, h:mm a' }}</td>
            <td>{{ item.bookedBy }}</td>
            <td>{{ item.toCity }}</td>
            <td>{{ item.senderName }}</td>
            <td>{{ item.receiverName }}</td>
            <td>{{ item.toTalPackages }}</td>
            <td>{{ item.totalCharge || 0 }}</td>
            <td>{{ item.doorPickupCharges || 0 }}</td>
            <td>{{ item.otherCharges || 0 }}</td>
            <td>{{ item.grandTotal || 0 }}</td>
          </tr>
    
          <!-- Totals Row -->
          <tr class="table-success fw-bold" *ngIf="branchReportData?.totals?.paid">
            <td colspan="7">Total</td>
            <td>{{ branchReportData?.totals?.paid?.totalParcels || 0 }}</td>
            <td>{{ branchReportData?.totals?.paid?.totalCharge || 0 }}</td>
            <td>{{ branchReportData?.totals?.paid?.doorPickupCharges || 0 }}</td>
            <td>{{ branchReportData?.totals?.paid?.otherCharges || 0 }}</td>
            <td>{{ branchReportData?.totals?.paid?.totalgrandTotal || 0 }}</td>
          </tr>
    
          <!-- No Data Row -->
          <tr *ngIf="!branchReportData?.BookingTypes?.paid?.length">
            <td colspan="12" class="text-center text-muted">No data available</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    
      <!-- table 2 -->
      <div class="table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
          <thead class="table-secondary">
            <!-- Custom Heading Row -->
            <tr>
              <th colspan="12" class="text-center">
                Booked To Pay Details
              </th>
            </tr>
      
            <!-- Column Headers -->
            <tr class="table-secondary">
              <th>No</th>
              <th>LR No</th>
              <th>Booking Date</th>
              <th>Booked By</th>
              <th>Destination</th>
              <th>Consignor</th>
              <th>Consignee</th>
              <th>Pkgs</th>
              <th>Freight</th>
              <th>Door Pickup</th>
              <th>Other</th>
              <th>Net Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of branchReportData?.BookingTypes?.toPay; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ item.lrNumber }}</td>
              <td>{{ item.bookingDate | date:'dd-MM-yyyy, h:mm a' }}</td>
              <td>{{ item.bookedBy }}</td>
              <td>{{ item.toCity }}</td>
              <td>{{ item.senderName }}</td>
              <td>{{ item.receiverName }}</td>
              <td>{{ item.toTalPackages }}</td>
              <td>{{ item.totalCharge || 0 }}</td>
              <td>{{ item.doorPickupCharges || 0 }}</td>
              <td>{{ item.otherCharges || 0 }}</td>
              <td>{{ item.grandTotal || 0 }}</td>
            </tr>
      
            <!-- Totals Row -->
            <tr class="table-success fw-bold" *ngIf="branchReportData?.totals?.toPay">
              <td colspan="7">Total</td>
              <td>{{ branchReportData?.totals?.toPay?.totalParcels || 0 }}</td>
              <td>{{ branchReportData?.totals?.toPay?.totalCharge || 0 }}</td>
              <td>{{ branchReportData?.totals?.toPay?.doorPickupCharges || 0 }}</td>
              <td>{{ branchReportData?.totals?.toPay?.otherCharges || 0 }}</td>
              <td>{{ branchReportData?.totals?.toPay?.totalgrandTotal || 0 }}</td>
            </tr>
      
            <!-- No Data Row -->
            <tr *ngIf="!branchReportData?.BookingTypes?.paid?.length">
              <td colspan="12" class="text-center text-muted">No data available</td>
            </tr>
          </tbody>
        </table>
      </div>

<!-- table-3 -->
<div class="table-responsive">
  <table class="table table-bordered table-sm text-center align-middle">
    <thead class="table-secondary">
      <!-- Custom Heading Row -->
      <tr>
        <th colspan="12" class="text-center">
          Booked Credit Details
        </th>
      </tr>

      <!-- Column Headers -->
      <tr class="table-secondary">
        <th>No</th>
        <th>LR No</th>
        <th>Booking Date</th>
        <th>Booked By</th>
        <th>Destination</th>
        <th>Consignor</th>
        <th>Consignee</th>
        <th>Pkgs</th>
        <th>Freight</th>
        <th>Door Pickup</th>
        <th>Other</th>
        <th>Net Amount</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of branchReportData?.BookingTypes?.credit; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ item.lrNumber }}</td>
        <td>{{ item.bookingDate | date:'dd-MM-yyyy, h:mm a' }}</td>
        <td>{{ item.bookedBy }}</td>
        <td>{{ item.toCity }}</td>
        <td>{{ item.senderName }}</td>
        <td>{{ item.receiverName }}</td>
        <td>{{ item.toTalPackages }}</td>
        <td>{{ item.totalCharge || 0 }}</td>
        <td>{{ item.doorPickupCharges || 0 }}</td>
        <td>{{ item.otherCharges || 0 }}</td>
        <td>{{ item.grandTotal || 0 }}</td>
      </tr>

      <!-- Totals Row -->
      <tr class="table-success fw-bold" *ngIf="branchReportData?.totals?.credit">
        <td colspan="7">Total</td>
        <td>{{ branchReportData?.totals?.credit?.totalParcels || 0 }}</td>
        <td>{{ branchReportData?.totals?.credit?.totalCharge || 0 }}</td>
        <td>{{ branchReportData?.totals?.credit?.doorPickupCharges || 0 }}</td>
        <td>{{ branchReportData?.totals?.credit?.otherCharges || 0 }}</td>
        <td>{{ branchReportData?.totals?.credit?.totalgrandTotal || 0 }}</td>
      </tr>

      <!-- No Data Row -->
      <tr *ngIf="!branchReportData?.BookingTypes?.paid?.length">
        <td colspan="12" class="text-center text-muted">No data available</td>
      </tr>
    </tbody>
  </table>
</div>
     
      <!-- table-4 -->
      <div class="table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
          <thead class="table-secondary">
          <!-- Custom Heading Row -->

          <tr>
            <th colspan="15" class="  text-center">
              Deliver ToPay Details
            </th>
          </tr>
          <!-- Column Headers -->
          <tr class="table-secondary">
            <th>No</th>
            <th>LR No</th>
            <th>Booking Date</th>
            <th>Booked By</th>
            <th>Remarks</th>
            <th>Destination</th>
            <th>Consignor</th>
            <th>Consignee</th>
            <th>Pkgs</th>
            <th>Freight</th>
            <th>Door Delivery Charge</th>
            <th>other Charge</th>
            <th>Amount</th>
            <th>Net Amount</th>
          </tr>
        </thead>
        <tbody>

          <tr *ngFor="let item of branchReportData.deliverToPayDetails let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ item.grnNo }}</td>
            <td>{{ item.deliveryDate| date:'dd-MM-yyyy, h:mm a' }}</td>
            <td>{{item.deliveryEmployee}}</td>
            <td></td>
            <td>{{ item.toCity }}</td>
            <td>{{ item.senderName }}</td>
            <td>{{ item.receiverName }}</td>
            <td>{{ item.totalPackages }}</td>
            <!-- <td>{{ item.doorDeliveryCharges }}</td> -->
            <td></td>
            <td>{{item.doorDeliveryCharges}}</td>
            <td>{{ item.otherCharges }}</td>
            <td>{{ item.totalAmount }}</td>
            <td>{{ item.grandTotal }}</td>

          </tr>
          <tr *ngIf="!branchReportData?.deliveredToPayDetails?.length">
            <td colspan="11" class="text-center text-muted">No data available</td>
          </tr>
        </tbody>
      </table>
      </div>

      <div class="table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
          <thead class="table-secondary">
            <tr>
              <th colspan="11" class="text-center">City Wise Booking Details</th>
            </tr>
            <tr>
              <th>City Name</th>
              <th>No Of Parcel</th>
              <th>Paid Amount</th>
              <th>To Pay Amount</th>
              <th>FOC Amount</th>
              <th>Credit For Amount</th>
              <th>Total Booking Amount</th>
              <th>Total Cancel Amount</th>
              <th>Total Amount</th>
              <th>Total Refund Charge</th>
              <th>Total Net Amount</th>
            </tr>
          </thead>
          <tbody >
            <tr *ngFor="let item of branchReportData.cityWiseBookingDetails">

              <td>{{ item.cities }}</td>
              <td>{{ item.noOfParcels || 0 }}</td>
              <td>{{ item.PaidAmount || 0 }}</td>
              <td>{{ item.ToPayAmount || 0 }}</td>
              <td>{{ item.FOCAmount || 0 }}</td>
              <td>{{ item.credit || 0 }}</td>
              <td>{{ item.totalBooking || 0 }}</td>
              <td>0</td> <!-- Total Cancel Amount (static or update if needed) -->
              <td>{{ item.netAmount || 0 }}</td>
              <td>{{ item.refundAmount || 0 }}</td>
              <td>{{ item.grandTotal  }}</td>
            </tr>

          </tbody>
          <tfoot class="fw-bold text-center table-success" *ngIf="branchReportData?.cityWiseTotal">
            <tr>
              <td>Total:</td>
              <td>{{ branchReportData.cityWiseTotal.noOfParcels }}</td>
              <td>{{ branchReportData.cityWiseTotal.PaidAmount }}</td>
              <td>{{ branchReportData.cityWiseTotal.ToPayAmount }}</td>
              <td>{{ branchReportData.cityWiseTotal.FOCAmount }}</td>
              <td>{{ branchReportData.cityWiseTotal.credit || 0 }}</td>
              <td>{{ getTotal('totalBooking') }}</td>
              <td>0</td>
              <td>{{ branchReportData.cityWiseTotal.totalNetAmount }}</td>
              <td>{{ branchReportData.cityWiseTotal.refundAmount }}</td>
              <td>{{ branchReportData.cityWiseTotal.grandTotal }}</td>
            </tr>
          </tfoot>
        </table>
      </div>



      <div class="table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
          <thead class="table-secondary">
            <tr>
              <th colspan="11" class="text-center">City Wise Delivery Details</th>
            </tr>
            <tr>
              <th>City Name</th>
              <th>No Of Parcel</th>
              <th>Paid Amount</th>
              <th>To Pay Amount</th>
              <th>FOC Amount</th>
              <th>Credit For Amount</th>
              <th>Total Booking Amount</th>
              <th>Total Cancel Amount</th>
              <th>Total Amount</th>
              <th>Total Refund Charge</th>
              <th>Total Net Amount</th>
            </tr>
          </thead>
          <tbody >
            <tr *ngFor="let item of branchReportData.cityWiseDeliveryDetails">
              <td>{{ item.cities }}</td>
              <td>{{ item.noOfParcels || 0 }}</td>
              <td>{{ item.PaidAmount || 0 }}</td>
              <td>{{ item.ToPayAmount || 0 }}</td>
              <td>{{ item.FOCAmount || 0 }}</td>
              <td>{{ item.credit || 0 }}</td>
              <td>{{ item.totalBooking || 0 }}</td>
              <td>0</td> <!-- Total Cancel Amount (static or update if needed) -->
              <td>{{ item.netAmount || 0 }}</td>
              <td>{{ item.refundAmount || 0 }}</td>
              <td>{{ item.grandTotal  }}</td>
            </tr>
          </tbody>
          
          <!-- Total Row (outside tbody) -->
          <tfoot class="fw-bold text-center table-success" *ngIf="branchReportData?.cityWiseDeliveryTotals">
            <tr>
              <td>Total:</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalParcels }}</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalPaidAmount }}</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalToPayAmount }}</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalFOCAmount }}</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.credit || 0 }}</td>
              <td>{{ getTotal('totalBooking') }}</td>
              <td>0</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalNetAmount }}</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalRefundAmount }}</td>
              <td>{{ branchReportData.cityWiseDeliveryTotals.totalGrandTotal }}</td>
            </tr>
          </tfoot>
          
          
        </table>
      </div>
      <div class="table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
          <thead class="table-secondary">
            <tr>
              <th colspan="12" class="text-center">Category Wise Booking Details</th>
            </tr>
            <tr>
              <th>CATEGORY</th>
              <th>No Of Pkgs</th>
              <th>Freight</th>
              <th>Loading</th>
              <th>Door Pickup</th>
              <th>Service Charge</th>
              <th>Door Delivery</th>
              <th>Other Charge</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Paid</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.noOfPackages || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.totalAmount || 0 }}</td>

              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.hamaliCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.doorPickupCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.serviceCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.doorDeliveryCharges || 0 }}</td>
         
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.paid?.otherCharges || 0 }}</td>
              <td class="fw-bold">{{ branchReportData?.CategoryWiseBookingDetails?.paid?.grandTotal || 0 }}</td>
            </tr>

            <tr>
              <td>To Pay</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.noOfPackages || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.totalAmount || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.hamaliCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.doorPickupCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.serviceCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.doorDeliveryCharges || 0 }}</td>
             
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.otherCharges || 0 }}</td>
              <td class="fw-bold">{{ branchReportData?.CategoryWiseBookingDetails?.toPay?.grandTotal || 0 }}</td>
            </tr>

            <tr>
              <td>ToPay Delivery</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.noOfPackages || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.totalAmount || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.hamaliCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.doorPickupCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.serviceCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.doorDeliveryCharges || 0 }}
              </td>
           
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.otherCharges || 0 }}</td>
              <td class="fw-bold">{{ branchReportData?.CategoryWiseBookingDetails?.toPayDeliveredAmount?.grandTotal || 0
                }}</td>
            </tr>

            <tr>
              <td>Credit</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit
                ?.noOfPackages || 0 }}</td>
                 <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit
                  ?.totalAmount || 0 }}</td>
                                <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit?.hamaliCharges || 0 }}</td>

              
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit
                ?.doorPickupCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit
                ?.serviceCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit
                ?.doorDeliveryCharges || 0 }}
              </td>
             
              <td>{{ branchReportData?.CategoryWiseBookingDetails?.credit
                ?.otherCharges || 0 }}</td>
              <td class="fw-bold">{{ branchReportData?.CategoryWiseBookingDetails?.credit
                ?.grandTotal || 0
                }}</td>
            </tr>
            <tr class="table-success fw-bold" *ngIf="branchReportData?.CategoryWiseBookingTotals">
              <td>Total</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.noOfPackages || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.totalAmount || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.hamaliCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.doorPickupCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.serviceCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.doorDeliveryCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.otherCharges || 0 }}</td>
              <td>{{ branchReportData?.CategoryWiseBookingTotals?.grandTotal || 0 }}</td>
            </tr>
            
      
          
          </tbody>
        </table>
      </div>
      <div class="table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
          <thead class=" d-flex justify-content-center" style="border: 2px solid black;">
            <tr>
              <th colspan="1" class="  text-center">
                Booking Total - Cancellation Total + Delivery Total :
              </th>
            </tr>

            <tr>
              <th colspan="4" class="  text-center">
                
              </th>
            </tr>



          </thead>

        </table>
      </div>

    </div>
  </div>